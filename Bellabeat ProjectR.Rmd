---
title: "Untitled"
output: github_document
---


Installing required packages for cleaning and visualizations
```{r}
```

loading tidyverse
```{r}
library(tidyverse)
library(readr)
```

loading data files into R 
```{r}
activity <- read.csv("dailyActivity_merged.csv")
```

```{r}
calories <- read.csv("hourlyCalories_merged.csv")
```

```{r}
intensities <- read.csv("hourlyIntensities_merged.csv")
```

```{r}
sleep <- read.csv("sleepDay_merged.csv")
```

```{3}
weight <- read.csv("weightLogInfo_merged.csv")
```

Preview of dataframes
```{r}
head(activity)
```

Identify all the columns in the daily_activity data.
```{r}
colnames(activity)
```

checking the sleep_day data.
```{r}
head(sleep)
```

Identify all columns in the daily_activity data.
```{r}
colnames(sleep)
```

```{r}
head(calories)
```

```{r}
head(intensities)
```

```{r}
head(weight)
```

checking data structure 
```{r}
str(activity)
```

```{r}
str(sleep)
```

```{r}
str(calories)
```

```{r}
str(intensities)
```

```{r}
str(weight)
```

Checking for duplicate rows
```{r}
nrow(activity[duplicated(activity),])
```

```{r}
nrow(sleep[duplicated(sleep),])
```

```{r}
nrow(weight[duplicated(weight),])
```

```{r}
nrow(calories[duplicated(calories),])
```

```{r}
nrow(intensities[duplicated(intensities),])
```

removing duplicate rows found in the sleep dataset
```{r}
sleep <- unique(sleep)
```

```{r}
nrow(sleep)
```
  
Checking the number of unique participants in each dataframe
```{r}
n_distinct(activity$Id)
```

```{r}
n_distinct(sleep$Id)
```

```{r}
n_distinct(calories$Id)
```

```{r}
n_distinct(intensities$Id)
```

```{r}
n_distinct(weight$Id)
```

checking the number of observations there are in each dataframe
```{r}
nrow(activity)
```

```{r}
nrow(sleep)
```

```{r}
nrow(calories)
```

```{r}
nrow(intensities)
```

```{r}
nrow(weight)
```

The following dataframes have the respective number of rows, activity - 940 rows, sleep - 410 rows, calories - 22099 rows, intensities - 22099 rows, and weight - 67 rows
there are only 8 participants in the weight dataframe compared to the others, this number is not enough for analysis
  
Standardizing date and time formats
```{r}
activity
activity$ActivityDate=as.POSIXct(activity$ActivityDate, format="%m/%d/%Y", tz=Sys.timezone())
```

```{r}
activity$date <- format(activity$ActivityDate, format = "%m/%d/%y")
```

```{r}
sleep
sleep$SleepDay=as.POSIXct(sleep$SleepDay, format="%m/%d/%Y %I:%M:%S %p", tz=Sys.timezone())
```

```{r}
sleep$date <- format(sleep$SleepDay, format = "%m/%d/%y")
```

```{3}
intensities
intensities$ActivityHour=as.POSIXct(intensities$ActivityHour, format="%m/%d/%Y %I:%M:%S %p", tz=Sys.timezone())
```

```{r}
intensities$time <- format(intensities$ActivityHour, format = "%H:%M:%S")
intensities$date <- format(intensities$ActivityHour, format = "%m/%d/%y")
```

```{r}
calories
calories$ActivityHour=as.POSIXct(calories$ActivityHour, format="%m/%d/%Y %I:%M:%S %p", tz=Sys.timezone())
```

```{r}
calories$time <- format(calories$ActivityHour, format = "%H:%M:%S")
```

```{r}
calories$date <- format(calories$ActivityHour, format = "%m/%d/%y")
```

a quick statistical summary of all dataframes to gain insights

```{r}
activity %>%
  select(TotalSteps,
          TotalDistance,
          VeryActiveMinutes,
          FairlyActiveMinutes,
          LightlyActiveMinutes,
          Calories,
          SedentaryMinutes) %>%
  summary()
```

```{r}
sleep %>%
  select(TotalSleepRecords,
          TotalMinutesAsleep,
          TotalTimeInBed) %>%
  summary()
```

```{r}
intensities %>%
  select(TotalIntensity,
          AverageIntensity)%>%
  summary()
```

```{r}
weight %>%
  select(WeightKg,
          WeightPounds,
          BMI)%>%
    summary()
```
    
This summary informs me that on avergae, participants are less active as mostly hours of inactivity were recorded compared to others. We can see that the recording of lightly active minutes on average (mean) amounts to 3hrs, and sedentary minutes amount to 16hrs, this a very long period of inactivity. Investigating habits through the day will reveal why this so.

For sleep summary, on average a participant slept for 7hrs once 
  
merging data for analysis and visualization
```{r}
activity_sleep <- merge(sleep, activity, by=c('Id', 'date'))
head(activity_sleep)
```


identifying relationships between minutes asleep and time in bed
```{r}
ggplot(data=sleep, aes(x=TotalMinutesAsleep, y=TotalTimeInBed)) + 
  geom_point() + 
  geom_smooth(method = lm) +
  labs(title="Relationship Between Total Minutes Asleep And Total Time in Bed")
```

```{r}
intensities2 <- intensities %>%
  group_by(time) %>%
  summarise(total_int_mean = mean(TotalIntensity))
```

A visualization to understand participants intensity habits through the day
```{r warning=FALSE}
ggplot(data=intensities2, aes(x=time, y=total_int_mean)) + geom_histogram(stat = "identity", fill='black') +
  theme(axis.text.x = element_text(angle = 0)) +
  labs(title="Average Total Intensity Through Hours Of The Day")
```
The above bar plot shows that the hours of 5pm to 7pm is when the most activity occurs. This may suggest that earlier times of less activity may be due to working hours preventing much activity for the earlier parts of the day.
  
Relationship between sedentary minutes and calories
```{r}
ggplot(data=activity_sleep, aes(x=SedentaryMinutes, y=Calories)) + 
  geom_point() + 
  labs(title="Relationship Between Sedentary Minutes And Calories")
```

There appears to be no relationship between both variables as the data points have no pattern. 
This can be a space Bellabeat can leverage on by suggesting/introducing healthy lifestyles to users.
Bellabeat can leverage on this by recording long sedentary habits and encourage users to be active as inacvtivity could lead to serious health problems.
  
Relationship between total steps and calories
```{r}
ggplot(data=activity_sleep, aes(x=TotalSteps, y=Calories)) + 
  geom_point() + 
  geom_smooth(method = lm) +
  labs(title="Relationship Between TotalSteps And Calories")
```
There appers to be a positive corroletion. Data points have an upward trend which confirms positive
relationship between Total steps and calories. This suggest that the more steps participants make, the more calories they burn. This can be used to inform users of their health achievements thereby increasing device engagement.
  
## RECOMENDATIONS
  ...based on the above insights to improve bellabeat app
1. Introduction of daily goals will encourage app engagement.
2. App notifications and reminders will inform users of their health and also introduce healthy habits.
3. Also, an easy app interface will lead to userfriendliness and increase customer retention.



  
^
